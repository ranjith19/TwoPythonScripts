import sysimport sqlite3import pyodbcimport connection_scriptimport logginglogging.basicConfig(filename='Sync_script.log',level=logging.DEBUG)try:	ms_con, ms_cur=connection_script.connect_to_mssql()	lite_con,lite_cur=connection_script.connect_to_sqlite()	ms_cur.execute("select prod_cd,whs_num,in_stock,lastrcv_qty,lastrcv_dt,price_base,frt_cus,prod_duty,handl_fee,misc_fee,avg_cost,lt_sl_dt,vendor,lst_order,ord_dt,stk_ind,back_qty,order_qty,on_order_qty,wip_qty,rma_qty,water_qty,ordersize,minstock,inv_loc,unit_color,class_cd,descrip,def_unit,updt_dt,phyc_dt,image_nm,oem_cd,alt_cd,updt_by,currency_cost,cost_factor  from inv_data ;")	for ms_row in ms_cur:			prod_cd = ms_row.prod_cd			sqlite_query="select prod_cd,whs_num,in_stock,lastrcv_qty,lastrcv_dt,price_base,frt_cus,prod_duty,handl_fee,misc_fee,avg_cost,lt_sl_dt,vendor,lst_order,ord_dt,stk_ind,back_qty,order_qty,on_order_qty,wip_qty,rma_qty,water_qty,ordersize,minstock,inv_loc,unit_color,class_cd,descrip,def_unit,updt_dt,phyc_dt,image_nm,oem_cd,alt_cd,updt_by,currency_cost,cost_factor  from inv_data from inv_data where prod_cd ='" +prod_cd+"';			#print sqlite_query			lite_cur.execute(sqlite_query)			lite_row=lite_cur.fetchone()			print type(lite_row)			print type(ms_row)						break						if not lite_row:					sqlite_query="insert into inv_data values('"+prod_cd+"','"+str(whs_num)+"','"+str(updt_dt)+"','N'"+");"					try:						lite_cur.execute(sqlite_query)						print 'insterted '+prod_cd						logging.info('insterted '+prod_cd)					except:						logging.info('Error:unexpected error at '+prd_cd+str(sys.exc_info()))						raise			elif lite_row:					if not (updt_dt == lite_row[2]):						try:							sqlite_query="update inv_data set updt_dt="+str(updt_dt)+" , status='N' where prod_cd ='" +prod_cd+"';"							lite_cur.execute(sqlite_query)							print 'updated '+prod_cd							logging.info('updated '+prod_cd)						except:							logging.info('Error:unexpected error at '+prd_cd+str(sys.exc_info()))							raise					else:                                                print ' not updated ',prod_cd	lite_con.commit()except:	print 'Error:unexpected error',sys.exc_info()