import sysimport sqlite3import pyodbcimport connection_scriptimport logginglogging.basicConfig(filename='db_sync.log',level=logging.DEBUG)try:	ms_con, ms_cur=connection_script.connect_to_mssql()	lite_con,lite_cur=connection_script.connect_to_sqlite()	ms_cur.execute("select prod_cd,whs_num,updt_dt from dbo.inv_data")	for ms_row in ms_cur:			prod_cd = ms_row.prod_cd			whs_num = ms_row.whs_num			updt_dt = ms_row.updt_dt			print updt_dt			sqlite_query="select * from inv_data where prod_cd ='" +prod_cd+"';"#and whs_num ="+str(whs_num)+";"			#print sqlite_query			lite_cur.execute(sqlite_query)			lite_row=lite_cur.fetchone()						if not lite_row:					sqlite_query="insert into inv_data values('"+prod_cd+"','"+str(whs_num)+"','"+str(updt_dt)+"','N'"+");"					try:						lite_cur.execute(sqlite_query)						print 'insterted '+prod_cd						logging.info('insterted '+prod_cd)					except:						logging.info('Error:unexpected error at '+prd_cd+str(sys.exc_info()))						raise			elif lite_row:					if not (updt_dt == lite_row[2]):						try:							sqlite_query="update inv_data set updt_dt="+str(updt_dt)+" , status='N' where prod_cd ='" +prod_cd+"';"							lite_cur.execute(sqlite_query)							print 'updated '+prod_cd							logging.info('updated '+prod_cd)						except:							logging.info('Error:unexpected error at '+prd_cd+str(sys.exc_info()))							raise					else:                                                print ' not updated ',prod_cd	lite_con.commit()except:	print 'Error:unexpected error',sys.exc_info()